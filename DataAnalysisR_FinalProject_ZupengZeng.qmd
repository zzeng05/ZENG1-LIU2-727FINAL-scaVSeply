---
author: "Zupeng Zeng & Troy Liu"
format: 
  pdf:
    include-in-header:
      text: |
        \addtokomafont{disposition}{\rmfamily}
        \usepackage{fancyhdr}
        \usepackage{setspace}
        \doublespacing
---
\raggedright
\pagestyle{fancy}
\fancyhf{}
\fancyfoot[L]{Zupeng Zeng & Troy Liu}
\fancyfoot[R]{\thepage}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0.382pt}

\begin{center} \includegraphics[width=0.3\columnwidth]{images} \end{center}

\begin{center} {\Large A Fancy metaphor title: Explain what to explore\par} \end{center}
\begin{center} {Novembver 2025} \end{center}

# Socio-Economic Background

|   Williamsburg, Virginia, known for its historical significance and educational institutions, presents a paradox within its socio-economic landscape. Despite a reputation as a peaceful, tourist-driven city, Williamsburg struggles with a significant housing crisis that reflects broader socio-economic challenges. A low poverty rate is offset by a high housing burden, where a substantial portion of residents—especially those working in essential local industries—face steep costs to maintain stable housing. Tourism and education drive the city’s economy, yet many workers cannot afford to live within city limits, as high property values and rents cater more to short-term tourist needs than to long-term residents (Trivette 2021).
| 

# Literature Review

|   The issue of eviction and housing instability has garnered significant attention in social scientific research, notably through the work of Matthew Desmond, whose seminal work *Evicted* provides a critical examination of the eviction crisis and its cascading impacts on poverty, inequality, and social stability (Desmond 2016). Desmond and others argue that housing insecurity is both a consequence and a driver of broader socio-economic inequality. Eviction disrupts lives, leading to job loss, educational setbacks, and long-term economic hardship, which Desmond describes as a cause, not just a condition, of poverty(Desmond 2016:2).
|   
\newpage

\begin{center} {\large \textbf{Exploratory Data Analysis Executive Summary}\par} \end{center}

- **Project Objective**: 
- **Data Source**: 
- **Data Reliability**:
- **THEME FOUND123**: 
- **Limitations of the Analysis**: 
\newpage

# Research Questions

- 
- 

# Data Source and Assumptions



# Data Cleaning Process 



# Notable Findings

***Finding 1.***
Finding Theme

State the finding in a few lines (See Figure 1 and Table 1).

***Finding 2.***
 (See Figure 2 and Table 2).

***Finding 3.***
(See Figure 3 and Table 3).

***Finding 4.***
(See Figure 4 and Table 4).
\ 

# Limitations


\newpage 

# Data Visualizations & Tables

```{r setup}
#| warning: false
#| echo: false
#| message: false
# Import Libraries
library(tidyverse)
library(lubridate)
library(rvest)
library(zoo)        # for rolling correlations
library(broom)      # for regression summaries
library(ggplot2)
library(stringr)
library(readxl)
```


```{r}
# Fetch SCA Data

cs_url <- "https://data.sca.isr.umich.edu/data-archive/mine.php#"

#Read the HTML and grab all tables
cs_tables <- read_html(cs_url) %>%
  html_elements("table") %>%
  html_table(fill = TRUE)

# 3) Rename columns and drop the first row ("Month", "Year", "Index")
cs_index <- cs_tables[[2]] %>%
  rename(
    month_chr = X1,
    year_chr  = X2,
    cs_chr    = X3
  ) %>%
  slice(-1) %>%                          # remove header row inside the table
  mutate(
    month = as.integer(month_chr),
    year  = as.integer(year_chr),
    cs    = as.numeric(cs_chr),
    date  = ymd(sprintf("%04d-%02d-01", year, month))
  ) %>%
  arrange(date) %>%
  select(date, cs, year, month)

head(cs_index)
```


```{r}
bls_key <- "554489bce3f14059aaa2dbb976d62372"

library(httr)
library(jsonlite)
library(dplyr)
library(tidyr)
library(lubridate)

# BLS series IDs:
# - LNS14000000: Unemployment rate (CPS, seasonally adjusted)
# - CES0000000001: All employees, total nonfarm (CES, thousands, SA)
series_ids <- c("LNS14000000", "CES0000000001")

# Request monthly data from 2008 to latest (adjust endyear as needed)
payload <- list(
  seriesid        = series_ids,
  startyear       = "2008",
  endyear         = "2025",      # change if you want a different end year
  registrationkey = bls_key
)

res <- POST(
  url   = "https://api.bls.gov/publicAPI/v2/timeseries/data/",
  body  = payload,
  encode = "json"
)

stop_for_status(res)

bls_json <- content(res, as = "text", encoding = "UTF-8")
bls_list <- fromJSON(bls_json, simplifyDataFrame = TRUE)
```

```{r}
library(purrr)
library(dplyr)
library(stringr)
library(lubridate)

series_tbl <- bls_list$Results$series

bls_long <- map_dfr(seq_len(nrow(series_tbl)), function(i) {
  series_id <- series_tbl$seriesID[i]
  dat       <- series_tbl$data[[i]]   # this is a data.frame for that series
  
  as_tibble(dat) %>%
    transmute(
      series_id = series_id,
      year      = as.integer(year),
      period,
      value     = as.numeric(value)
    ) %>%
    # keep monthly observations (M01–M12)
    filter(str_starts(period, "M")) %>%
    mutate(
      month = as.integer(str_remove(period, "M")),
      date  = ymd(sprintf("%04d-%02d-01", year, month))
    )
})

head(bls_long)
```
```{r}
# CPS unemployment rate
unemp_cps <- bls_long %>%
  filter(series_id == "LNS14000000") %>%
  arrange(date) %>%
  transmute(
    date,
    unrate = value
  )

# CES total nonfarm employment & monthly job change
jobs_ces <- bls_long %>%
  filter(series_id == "CES0000000001") %>%
  arrange(date) %>%
  transmute(
    date,
    nonfarm_emp = value,
    job_change  = nonfarm_emp - lag(nonfarm_emp)
  )
```

### Table 25 Current Business Conditions Compared with a Year Ago
```{r}
table25_data <- list(
  table = "25",
  format = "html",
  from = "2008",
  to = "2025",
  freq = "monthly"
)

res <- POST(cs_url, body = table25_data, encode = "form")

page <- read_html(res)

tab25 <- page %>%
  html_node("div.output table") %>%
  html_table(fill = TRUE)

tab25
```

```{r}
clean_tab25 <- tab25 %>%
  { setNames(., as.character(unlist(.[1, ]))) } %>%
  slice(-1) %>%
  mutate(
    Month = as.integer(Month),
    Year  = as.integer(Year),
    `Better Now` = as.numeric(`Better Now`),
    Same         = as.numeric(Same),
    `Worse Now`  = as.numeric(`Worse Now`),
    `DK; NA`     = as.numeric(`DK; NA`),
    Relative     = as.numeric(Relative),
    date         = as.Date(sprintf("%04d-%02d-01", Year, Month))
  ) %>%
  relocate(date)

clean_tab25
```

### Table 30 Expected Change in Unemployment During the Next Year
```{r}
table30_data <- list(
  table = "30",
  format = "html",
  from = "2008",
  to = "2025",
  freq = "monthly"
)

res <- POST(cs_url, body = table30_data, encode = "form")

page <- read_html(res)

tab30 <- page %>%
  html_node("div.output table") %>%
  html_table(fill = TRUE)

tab30
```

```{r}
clean_tab30 <- tab30 %>%
  { setNames(., as.character(unlist(.[1, ]))) } %>%
  slice(-1) %>%
  mutate(
    Month = as.integer(Month),
    Year  = as.integer(Year),
    Less  = as.numeric(Less),
    Same  = as.numeric(Same),
    More  = as.numeric(More),
    `DK; NA` = as.numeric(`DK; NA`),
    Relative = as.numeric(Relative),
    date = as.Date(sprintf("%04d-%02d-01", Year, Month))
  ) %>%
  relocate(date) 
clean_tab30
```







```{r}
#| echo: false
# Read the Data
path <- 'eviction_dataset.xlsx'
sheets <- openxlsx::getSheetNames(path)
data_frame <- lapply(sheets, openxlsx::read.xlsx, xlsxFile = path)
names(data_frame) <- sheets
pre <- data_frame$`201906-07`
post <- data_frame$`202206-07`

# Function to make column names unique
make_unique_names <- function(df) {
  names(df) <- make.unique(names(df))
  return(df)
}

# Make column names unique and combine data
make_unique_names <- function(df) {
    names(df) <- make.unique(names(df))
    return(df)
}
pre <- make_unique_names(pre)
post <- make_unique_names(post)
combined_data <- bind_rows(mutate(pre, Period = "Pre-COVID"), mutate(post, Period = "Post-COVID"))
```

## Figure 1. Comparison of Principal Amounts
```{r}
#| echo: false
#| warning: false
# Adjust the factor levels for consistent ordering in plots
combined_data$Period <- factor(combined_data$Period, levels = c("Pre-COVID", "Post-COVID"))

# Boxplot for comparing principal amount distributions
ggplot(combined_data, aes(x = Period, y = Principal.Amount, fill = Period)) +
  geom_boxplot() +
  labs(title = "Principal Amounts Pre- and Post-COVID",
       x = "",
       y = "Principal Amount ($)") +
  scale_fill_brewer(palette = "Set1") +
  theme_minimal() +
  theme(legend.title = element_blank())
```

## Table 1.
```{r}
#| echo: false
#| warning: false
# Table of Principal Amounts Summary Statistics
principal_summary <- combined_data %>%
  group_by(Period) %>%
  summarise(
    Min = min(Principal.Amount, na.rm = TRUE),
    Median = median(Principal.Amount, na.rm = TRUE),
    Mean = mean(Principal.Amount, na.rm = TRUE),
    Max = max(Principal.Amount, na.rm = TRUE)
  ) %>%
  arrange(Period)

#Make the table
principal_summary %>%
  kable("latex", booktabs = TRUE, caption = "Summary Statistics for Principal Amounts (USD)") %>%
  kable_styling(latex_options = c("striped", "hold_position")) %>%
  column_spec(1, bold = TRUE, color = "black")
```
- The data indicates a clear increase in principal amounts over time, possibly due to multiple continuances in 2022 as Rent Relief Program (RRP) claims were processed, leading to accumulated amounts owed in each Unlawful Detainer case.
\newpage 

## Figure 2. Comparison of Attorney Representation Rates
```{r}
#| echo: false
#| warning: false
# Categorizing attorney presence
combined_data <- combined_data %>%
  mutate(AttorneyStatus = case_when(
    Attorney %in% c("NONE", "Information Unavailable", NA, "0") ~ "Without Attorney",
    TRUE ~ "With Attorney"
  ))

# Grouping and calculating percentages
attorney_representation <- combined_data %>%
  group_by(Period, AttorneyStatus) %>%
  summarise(Cases = n(), .groups = 'drop') %>%
  group_by(Period) %>%
  mutate(Percentage = Cases / sum(Cases) * 100)

# Plotting pie chart with labels in the center of each segment
ggplot(attorney_representation, aes(x = "", y = Percentage, fill = AttorneyStatus)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar(theta = "y") +  # Convert bar to pie chart
  facet_wrap(~ Period, scales = "free_x", as.table = FALSE) +
  theme_void() +
  labs(title = "Attorney Representation Rates Pre- and Post-COVID", fill = NULL) +  # Set legend title to NULL
  scale_fill_manual(values = c("With Attorney" = "blue", "Without Attorney" = "darkred")) +
  theme(legend.position = "bottom") +
  geom_text(aes(label = paste0(round(Percentage, 0), "%")), 
            position = position_stack(vjust = 0.5), color = "white", size = 4)
```

## Table 2.
```{r}
#| echo: false
#| warning: false
# Prepare the data for the table
attorney_representation_table <- combined_data %>%
  group_by(Period, AttorneyStatus) %>%
  summarise(Cases = n(), .groups = 'drop') %>%
  group_by(Period) %>%
  mutate(Percentage = Cases / sum(Cases) * 100) %>%
  ungroup() %>%
  arrange(Period, AttorneyStatus)

# Displaying the table
attorney_representation_table %>%
  kable("latex", booktabs = TRUE, caption = "Attorney Representation Statistics") %>%
  kable_styling(latex_options = c("striped", "hold_position")) %>%
  column_spec(1, bold = TRUE, color = "black") %>%
  column_spec(3, width = "6em")
```
- The data suggests a decreased access to legal support for tenants in the post-COVID period, which may have implications for the fairness and outcomes of eviction proceedings.
\newpage 

## Figure 3. Judgment Outcome Distribution Stacked
![](Part2.png)

## Table 3.
```{r}
#| echo: false
#| warning: false
# Prepare data with counts and percentages
judgment_stats <- combined_data %>%
  group_by(Period, Judgement) %>%
  summarise(Count = n(), .groups = 'drop') %>%
  group_by(Period) %>%
  mutate(Percentage = round(100 * Count / sum(Count), 2)) %>%
  ungroup() %>%
  arrange(Period)

# Display the Table with counts and percentages
judgment_stats %>%
  kable("latex", booktabs = TRUE, caption = "Judgment Outcomes Statistics", col.names = c("Period", "Judgement", "Count", "Percentage (%)")) %>%
  kable_styling(latex_options = c("striped", "hold_position")) %>%
  column_spec(1, bold = TRUE, color = "black")
```
 - In 2022, an increase in case dismissals and non-suits—often indicating tenant non-liability or landlords’ reduced grounds for eviction due to rent payments or insufficient proof—correlates with a decline in plaintiff (landlord) victories, suggesting a potential positive impact of the Rent Relief Program (RRP) implemented during the pandemic.
 
\newpage 

## Figure 4. Case Time Length Distribution Density
```{r}
#| echo: false
#| warning: false
# Calculate Case Time Length for pre and post data
pre$Case.Time.Length <- as.Date(as.character(pre$Hearing.Date), format="%m/%d/%Y") -
                        as.Date(as.character(pre$Filed.Date), format="%m/%d/%Y")
post$Case.Time.Length <- as.Date(as.character(post$date), format="%m/%d/%Y") -
                         as.Date(as.character(post$filed.date), format="%m/%d/%Y")

# Combine the pre and post data
combined_data <- bind_rows(
  mutate(pre, Period = "Pre-COVID"),
  mutate(post, Period = "Post-COVID")
)

# Visualize Case Time Length Distribution
ggplot(combined_data, aes(x = Case.Time.Length, fill = Period)) +
  geom_density(alpha = 0.5) +
  labs(title = "Case Time Length Distribution Pre- and Post- COVID",
       x = "Case Time Length (Day)", y = "Density") +
  scale_fill_brewer(palette = "Set2") +
  theme_minimal() +
  theme(legend.title = element_blank(), panel.grid = element_blank())
```

## Table 4.
```{r}
#| echo: false
#| warning: false
# Calculate summary statistics for Case Time Length
case_time_stats <- combined_data %>%
  group_by(Period) %>%
  summarise(
    Min = min(Case.Time.Length, na.rm = TRUE),
    Median = median(Case.Time.Length, na.rm = TRUE),
    Mean = mean(Case.Time.Length, na.rm = TRUE),
    Max = max(Case.Time.Length, na.rm = TRUE),
    .groups = 'drop'
  ) %>%
  arrange(desc(Period))

# Render table
case_time_stats %>%
  kable("latex", booktabs = TRUE, caption = "Summary Statistics for Case Time Length") %>%
  kable_styling(latex_options = c("striped", "hold_position")) %>%
  column_spec(1, bold = TRUE, color = "black")
```
 - The time length exhibits a trend parallel to the principal amount distribution, revealing a higher number of cases with substantial principal amounts and extended case duration. This pattern highlights the potential correlation between larger debts and longer case duration. To further validate our hypothesis, it is necessary to examine whether cases with high principal amounts correspond to those with extended continuance duration.

\newpage 

# Indications
**Strengthening Tenant Protections.**


\newpage

# Conclusion & Outlook

|   The COVID-19 pandemic intensified pre-existing challenges in the U.S. housing system, with eviction practices in Williamsburg and James City County illustrating how policies and socio-economic factors shape housing stability(Oliver 2020; Trivette 2021). This research examined shifts in eviction rates, legal outcomes, and financial burdens on tenants and landlords before and during the pandemic. Increases in case dismissals and non-suits, alongside decreased plaintiff victories, suggest that pandemic-era tenant protections had an impact. Additionally, the rise in principal amounts over time may reflect extended case durations due to the processing time of the Rent Relief Program, though further investigation is needed to confirm this correlation.

\newpage 

# References




